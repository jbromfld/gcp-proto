<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net">
  <diagram name="RAG Architecture" id="rag-architecture">
    <mxGraphModel dx="1434" dy="790" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        
        <!-- User Interface Layer -->
        <mxCell id="ui" value="Streamlit UI&#xa;rag_ui.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FE;strokeColor=#01579B;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="700" y="40" width="200" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="api" value="FastAPI Backend&#xa;rag_api.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FE;strokeColor=#01579B;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="700" y="160" width="200" height="80" as="geometry"/>
        </mxCell>
        
        <!-- Core RAG Engine -->
        <mxCell id="rag" value="RAG Service&#xa;rag_service.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#4A148C;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="700" y="280" width="200" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="emb" value="Embedding Service&#xa;rag_embeddings.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#4A148C;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="400" width="180" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="llm" value="LLM Service&#xa;rag_llm_abstraction.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#4A148C;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="920" y="400" width="180" height="80" as="geometry"/>
        </mxCell>
        
        <!-- Vector Store -->
        <mxCell id="es" value="Elasticsearch&#xa;Vector Store" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#E8F5E8;strokeColor=#1B5E20;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="720" y="540" width="160" height="100" as="geometry"/>
        </mxCell>
        
        <!-- ETL Pipeline -->
        <mxCell id="etl" value="ETL Pipeline&#xa;rag_etl_pipeline.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#1B5E20;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="280" y="280" width="180" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="chunk" value="Document Chunker&#xa;500 tokens, 50 overlap" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#1B5E20;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="280" y="400" width="180" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="scraper" value="Web Scraper&#xa;BeautifulSoup4" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E8;strokeColor=#1B5E20;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="280" y="160" width="180" height="60" as="geometry"/>
        </mxCell>
        
        <!-- Local Development Box -->
        <mxCell id="local-box" value="Local Development (FREE)" style="swimlane;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#880E4F;fontSize=14;fontStyle=1;startSize=30" vertex="1" parent="1">
          <mxGeometry x="40" y="400" width="200" height="260" as="geometry"/>
        </mxCell>
        
        <mxCell id="local-llm" value="Ollama&#xa;llama3.2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#880E4F;fontSize=12" vertex="1" parent="local-box">
          <mxGeometry x="20" y="50" width="160" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="local-emb" value="sentence-transformers&#xa;all-MiniLM-L6-v2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#880E4F;fontSize=12" vertex="1" parent="local-box">
          <mxGeometry x="20" y="130" width="160" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="local-es" value="Elasticsearch&#xa;Docker:9200" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#880E4F;fontSize=12" vertex="1" parent="local-box">
          <mxGeometry x="20" y="210" width="160" height="40" as="geometry"/>
        </mxCell>
        
        <!-- GCP Production Box -->
        <mxCell id="gcp-box" value="GCP Production" style="swimlane;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#E65100;fontSize=14;fontStyle=1;startSize=30" vertex="1" parent="1">
          <mxGeometry x="1200" y="280" width="340" height="360" as="geometry"/>
        </mxCell>
        
        <mxCell id="vertex-llm" value="Vertex AI&#xa;gemini-1.5-flash" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="20" y="50" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="vertex-emb" value="Vertex AI&#xa;text-embedding-004" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="180" y="50" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="cr-api" value="Cloud Run API&#xa;2 CPU, 4GB RAM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="20" y="130" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="cr-ui" value="Cloud Run UI&#xa;1 CPU, 2GB RAM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="180" y="130" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="cr-etl" value="Cloud Run ETL&#xa;2 CPU, 4GB RAM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="20" y="210" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="scheduler" value="Cloud Scheduler&#xa;Daily ETL trigger" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="180" y="210" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="gce-es" value="Elasticsearch GCE&#xa;e2-medium VM" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#FFFFFF;strokeColor=#E65100;fontSize=12" vertex="1" parent="gcp-box">
          <mxGeometry x="100" y="290" width="140" height="60" as="geometry"/>
        </mxCell>
        
        <!-- Feedback -->
        <mxCell id="feedback" value="Feedback Store&#xa;rag_evaluation.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FE;strokeColor=#01579B;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="1000" y="160" width="160" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="metrics" value="Metrics &amp; Analytics&#xa;Thumbs up/down, P95" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1F5FE;strokeColor=#01579B;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="1000" y="40" width="160" height="60" as="geometry"/>
        </mxCell>
        
        <!-- Arrows -->
        <mxCell edge="1" parent="1" source="ui" target="api">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="api" target="rag">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="rag" target="emb">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="rag" target="llm">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="emb" target="es">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="rag" target="es">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="etl" target="chunk">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="chunk" target="emb">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="scraper" target="etl">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="etl" target="es">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="api" target="feedback">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="feedback" target="metrics">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <!-- Dashed arrows for provider selection -->
        <mxCell edge="1" parent="1" source="llm" target="local-llm" style="dashed=1;strokeColor=#880E4F">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="emb" target="local-emb" style="dashed=1;strokeColor=#880E4F">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="llm" target="vertex-llm" style="dashed=1;strokeColor=#E65100">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell edge="1" parent="1" source="emb" target="vertex-emb" style="dashed=1;strokeColor=#E65100">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>